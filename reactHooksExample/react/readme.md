## 12
- 大家好，我是响果前端的mango。
本次我带来的是在react-hooks中运用useRef来解决异步回调函数中使用useState，却无法获取获取当前最新的state的值的问题。
- 首先我来介绍一下useRef的作用，它的作用是返回一个可变的ref对象，有一个current属性，可以得到当前对象的值。
- 我使用的配置是和第一期中展示的一样，不清楚的小伙伴可以转到第一期视频配一下。
- 接下来开始写我们的demo了。我们将使用useEffect，这个函数在之前也都有讲过，小伙伴们应该也比较熟悉了，就不过多叙述了。
首先是写两个useState声明的变量seconds和message
在useEffect之中，我们会使用setTimout来模拟异步回调函数，
第一个setTimout在一秒后修改seconds的值为1
第二个setTimout在三秒后修改message的值为 并引用seconds
在理想情况下，页面中显示的数字应该都是0
看看

实际上message中输出的并不是1，而是0；
这就是开始提到要解决的问题的情况，而产生这种问题的原因就是神奇的闭包了，采用hooks，因为是函数，不可避免的会遇到闭包的副作用。
闭包就是指有权访问另一个函数作用域中的变量的函数。useEffect引用了外部的seconds，形成了闭包，一直保存着一开是传递进来的seconds的值，虽然当前外部的seconds的值已经改变了，但Effect由于依赖为空只进行了一次，里面的second的值还是一开始传进来的时候的0，就出现了我们现在的问题。
接下就是关键的使用useRef来解决这个问题了
- 我再来介绍一下useRef的作用，它的作用是返回一个可变的ref对象，有一个current属性，可以得到当前对象的值。

本期视频就到这里了，欢迎小伙伴们点赞评论投币三连!
大家有什么问题也可以在视频下方评论，我会和大家一起讨论一起学习。我是mango，和你一起学前端，期待下一次的相见。

## 13 
- 大家好，我是响果前端的mango。
本次我带来的是在react-hooks中运用useRef来解决数据请求回来但组件已经被卸载而导致的内存泄漏的问题。
JSONPlaceholder 是一个提供免费的在线 REST API 的网站，我们在开发时可以使用它提供的 url 地址测试下网络请求以及请求参数。或者当我们程序需要获取一些假数据、假图片时也可以使用它。
- 我使用的配置是和第一期中展示的一样，不清楚的小伙伴可以转到第一期视频配一下。
- 接下来开始写我们的demo了。我们将使用useState来控制组件的渲染和移除，这个操作在之前也都有讲过，小伙伴们还记得吗？来一起写一下吧

- 接下来我们来写子组件MyChildComponent,这个组件使用filter（接受输入）和userCollection（接收数据），
现在我们想要模拟一个请求数据的行为，因为请求数据是需要时间的，不是立马就能请求到的，所以我们用setTimeout来模拟，

- 这时控制台会报错，内存泄漏，导致这个错误原因是，我们的数据请求回来后，会调用setUserCollection方法更新组件，但此时组件已经被卸载了。因此我们可以模仿父组件的操作，我们运用useRef来定义一个mountRef的变量控制是否调用setUserCollection方法更新组件，在组件挂载的时候mountRef为true，组件卸载的时候为false，usEffect的用法在之前讲过不细说，

本期视频就到这里了，欢迎小伙伴们点赞评论投币三连!
大家有什么问题也可以在视频下方评论，我会和大家一起讨论一起学习。我是mango，和你一起学前端，期待下一次的相见。



## 14
- 大家好，我是mango，
本次要讲解的是hooks中使用useRef方法得到dom节点的操作，
useRef的作用是返回一个可变的ref对象，它有一个current属性，可以得到当前对象的值。
React提供的这个ref属性，表示为对组件真正实例的引用，其实就是ReactDOM.render()返回的组件实例；
ReactDOM.render()渲染组件时返回的是组件实例；
渲染dom元素时，返回是具体的dom节点。
ref可以挂载到组件上也可以是dom元素上；

可以在dom节点上使用